/*! sink.min.js build:0.0.0, production. Copyright(c) 2013 Eric Zhang, Michelle Bu, Rolland Wu MIT Licensed */(function(e){function t(e,t){var n={},r=Proxy.create(util.getChromeProxyFunctions(n)),i=new WebSocket("localhost:9000"),s=1,o={};i.onmessage=function(e){var n=e.data[0],i=e.data[1],u=i[0],a=i[1],f=i[2];if(n=="init"){for(var l=0,c=i.length;l<c;l++)r[u]=a;s=f,t(r)}else if(n=="update")if(f>s+1)o[f]=e;else if(f===s+1){for(var l=0,c=i.length;l<c;l++)r[u]=a;updateKeys=Object.keys(o);if(updateKeys.length!==0){var h=f+1;while(o[h]){var d=o[h],v=d[1],m=updateProperties[0],g=updateProperties[1];for(var l=0,c=updateProperties.length;l<c;l++)r[m]=updateLength;delete o[h],h+=1}}}else console.log("received old version: "+f),console.log("Current version is: "+s);else n=="collision"?console.log("Collision Detected!"):n=="success"&&(s=f)}}util={getChromeProxyFunctions:function(e){return{get:function(t,n){return e[n]},set:function(t,n,r){var i=new WebSocket("localhost:9090");console.log("version");var s=["update",n,r,version];e[n]=r},getOwnPropertyDescriptor:function(t){var n=Object.getOwnPropertyDescriptor(e,t);return n!==undefined&&(n.configurable=!0),n},getPropertyDescriptor:function(t){var n=Object.getPropertyDescriptor(e,t);return n!==undefined&&(n.configurable=!0),n},getOwnPropertyNames:function(){return Object.getOwnPropertyNames(e)},getPropertyNames:function(t){return Object.getPropertyNames(e)},defineProperty:function(t,n){Object.defineProperty(e,t,n)},"delete":function(t){return delete e.name},fix:function(){if(Object.isFrozen(e)){var t={},n=Object.getOwnPropertyNames(e);for(var r=0,i=n.length;r<i;r+=1){var s=n[r];t[s]=Object.getOwnPropertyDescriptor(e,s)}return t}return undefined}}},setZeroTimeout:function(e){function r(r){t.push(r),e.postMessage(n,"*")}function i(r){r.source==e&&r.data==n&&(r.stopPropagation&&r.stopPropagation(),t.length&&t.shift()())}var t=[],n="zero-timeout-message";return e.addEventListener?e.addEventListener("message",i,!0):e.attachEvent&&e.attachEvent("onmessage",i),r}(this)},e.sink=t})(this)